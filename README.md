# Telegram Mood Bot

Telegram бот для анализа настроения пользователя по голосовым и текстовым сообщениям.

## Функциональность

- Распознавание голосовых сообщений с помощью Deepgram API
- Анализ настроения пользователя по тексту
- Поддержка различных состояний настроения:
  - Позитивное (радость, удовлетворение, вдохновение)
  - Негативное (грусть, тревога, разочарование)
  - Усталость (физическая и эмоциональная)
  - Энергичность (физическая бодрость и ментальная ясность)
  - Нейтральное
- Интерактивные упражнения для улучшения настроения
- Система логирования всех взаимодействий

## Система логирования

Бот ведет подробный лог всех взаимодействий в формате JSON. Для каждого сообщения записывается:
- Временная метка (timestamp)
- ID пользователя
- Имя пользователя
- Тип сообщения (голосовое/текстовое/callback)
- Содержимое сообщения (текст или транскрипция голосового)
- Ответ бота
- Определенное настроение (если применимо)

Логи сохраняются в директории `logs/bot.log` и не включаются в систему контроля версий.

## Установка и запуск

1. Клонируйте репозиторий:
```bash
git clone [repository-url]
cd tg_bot
```

2. Создайте файл `.env` с необходимыми переменными окружения:
```env
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
DEEPGRAM_API_KEY=your_deepgram_api_key
DEV=true  # для разработки
```

3. Установите зависимости:
```bash
go mod download
```

4. Запустите бота:
```bash
go run cmd/bot/main.go
```

## Структура проекта

```
.
├── cmd/
│   └── bot/
│       └── main.go          # Точка входа
├── internal/
│   ├── bot/
│   │   └── bot.go          # Основная логика бота
│   ├── speech/
│   │   └── deepgram.go     # Интеграция с Deepgram API
│   └── logger/
│       └── logger.go       # Система логирования
├── design/
│   └── mood_responses.md   # Схема поведения бота
├── logs/                   # Директория для логов
├── temp/                   # Временные файлы
├── .env                    # Конфигурация окружения
├── .env.dev               # Конфигурация для разработки
├── .gitignore
└── README.md
```

## Распознавание настроения

Бот использует расширенный словарь для определения настроения пользователя, включая:
- Базовые эмоциональные состояния
- Разговорные выражения
- Матерные выражения (для более точного определения настроения)
- Физические и ментальные состояния
- Контекстные фразы

## Упражнения и практики

### Для позитивного настроения
1. "Вижу, слышу, чувствую" - практика осознанности для закрепления позитивного состояния
2. "ABC noting" - техника осознанности для усиления позитивного состояния

### Для усталости и негативного настроения
1. Глубокое дыхание
2. Растяжка шеи
3. Мини-прогулка
4. Гимнастика для глаз

## Управление ботом

- Запуск: отправьте команду `/start` или напишите "привет"
- Голосовые сообщения: отправьте голосовое сообщение для анализа настроения
- Текстовые сообщения: напишите о своем состоянии
- Упражнения: выбирайте из предложенных кнопок

## Разработка

Для разработки:
1. Установите `DEV=true` в `.env.dev`
2. Используйте `.env.dev` для локальной разработки
3. Логи будут доступны в `logs/bot.log`

## Лицензия

MIT 